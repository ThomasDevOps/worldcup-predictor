-- Migration: Add TBD placeholder teams for knockout stages
-- These teams will be replaced with actual teams as they qualify

-- Create TBD teams for knockout rounds
INSERT INTO teams (id, name, country_code, group_name) VALUES
  -- Group stage qualifiers
  ('00000000-0000-0000-0000-000000000001', 'TBD (Winner Group A)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000002', 'TBD (Runner-up Group A)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000003', 'TBD (Winner Group B)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000004', 'TBD (Runner-up Group B)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000005', 'TBD (Winner Group C)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000006', 'TBD (Runner-up Group C)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000007', 'TBD (Winner Group D)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000008', 'TBD (Runner-up Group D)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000009', 'TBD (Winner Group E)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000010', 'TBD (Runner-up Group E)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000011', 'TBD (Winner Group F)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000012', 'TBD (Runner-up Group F)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000013', 'TBD (Winner Group G)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000014', 'TBD (Runner-up Group G)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000015', 'TBD (Winner Group H)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000016', 'TBD (Runner-up Group H)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000017', 'TBD (Winner Group I)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000018', 'TBD (Runner-up Group I)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000019', 'TBD (Winner Group J)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000020', 'TBD (Runner-up Group J)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000021', 'TBD (Winner Group K)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000022', 'TBD (Runner-up Group K)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000023', 'TBD (Winner Group L)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000024', 'TBD (Runner-up Group L)', 'XX', 'Knockout'),
  -- 3rd place qualifiers (8 best third-placed teams)
  ('00000000-0000-0000-0000-000000000025', 'TBD (3rd Place 1)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000026', 'TBD (3rd Place 2)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000027', 'TBD (3rd Place 3)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000028', 'TBD (3rd Place 4)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000029', 'TBD (3rd Place 5)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000030', 'TBD (3rd Place 6)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000031', 'TBD (3rd Place 7)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000032', 'TBD (3rd Place 8)', 'XX', 'Knockout'),
  -- Round of 32 winners
  ('00000000-0000-0000-0000-000000000033', 'TBD (R32 Winner 1)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000034', 'TBD (R32 Winner 2)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000035', 'TBD (R32 Winner 3)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000036', 'TBD (R32 Winner 4)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000037', 'TBD (R32 Winner 5)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000038', 'TBD (R32 Winner 6)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000039', 'TBD (R32 Winner 7)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-00000000003a', 'TBD (R32 Winner 8)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-00000000003b', 'TBD (R32 Winner 9)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-00000000003c', 'TBD (R32 Winner 10)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-00000000003d', 'TBD (R32 Winner 11)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-00000000003e', 'TBD (R32 Winner 12)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-00000000003f', 'TBD (R32 Winner 13)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000040', 'TBD (R32 Winner 14)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000071', 'TBD (R32 Winner 15)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000072', 'TBD (R32 Winner 16)', 'XX', 'Knockout'),
  -- Round of 16 winners
  ('00000000-0000-0000-0000-000000000041', 'TBD (R16 Winner 1)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000042', 'TBD (R16 Winner 2)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000043', 'TBD (R16 Winner 3)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000044', 'TBD (R16 Winner 4)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000045', 'TBD (R16 Winner 5)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000046', 'TBD (R16 Winner 6)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000047', 'TBD (R16 Winner 7)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000048', 'TBD (R16 Winner 8)', 'XX', 'Knockout'),
  -- Quarter-final winners/losers
  ('00000000-0000-0000-0000-000000000051', 'TBD (QF Winner 1)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000052', 'TBD (QF Winner 2)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000053', 'TBD (QF Winner 3)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000054', 'TBD (QF Winner 4)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000055', 'TBD (QF Loser 1)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000056', 'TBD (QF Loser 2)', 'XX', 'Knockout'),
  -- Semi-final winners/losers
  ('00000000-0000-0000-0000-000000000061', 'TBD (SF Winner 1)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000062', 'TBD (SF Winner 2)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000063', 'TBD (SF Loser 1)', 'XX', 'Knockout'),
  ('00000000-0000-0000-0000-000000000064', 'TBD (SF Loser 2)', 'XX', 'Knockout')
ON CONFLICT (id) DO NOTHING;

-- Update knockout matches to use TBD teams
-- Round of 32
WITH r32_matches AS (
  SELECT id, ROW_NUMBER() OVER (ORDER BY match_date) as rn
  FROM matches WHERE stage = 'Round of 32'
)
UPDATE matches m SET
  home_team_id = CASE
    WHEN r.rn = 1 THEN '00000000-0000-0000-0000-000000000001'::uuid
    WHEN r.rn = 2 THEN '00000000-0000-0000-0000-000000000003'::uuid
    WHEN r.rn = 3 THEN '00000000-0000-0000-0000-000000000005'::uuid
    WHEN r.rn = 4 THEN '00000000-0000-0000-0000-000000000007'::uuid
    WHEN r.rn = 5 THEN '00000000-0000-0000-0000-000000000009'::uuid
    WHEN r.rn = 6 THEN '00000000-0000-0000-0000-000000000011'::uuid
    WHEN r.rn = 7 THEN '00000000-0000-0000-0000-000000000013'::uuid
    WHEN r.rn = 8 THEN '00000000-0000-0000-0000-000000000015'::uuid
    WHEN r.rn = 9 THEN '00000000-0000-0000-0000-000000000017'::uuid
    WHEN r.rn = 10 THEN '00000000-0000-0000-0000-000000000019'::uuid
    WHEN r.rn = 11 THEN '00000000-0000-0000-0000-000000000021'::uuid
    WHEN r.rn = 12 THEN '00000000-0000-0000-0000-000000000023'::uuid
    WHEN r.rn = 13 THEN '00000000-0000-0000-0000-000000000025'::uuid
    WHEN r.rn = 14 THEN '00000000-0000-0000-0000-000000000027'::uuid
    WHEN r.rn = 15 THEN '00000000-0000-0000-0000-000000000029'::uuid
    WHEN r.rn = 16 THEN '00000000-0000-0000-0000-000000000031'::uuid
  END,
  away_team_id = CASE
    WHEN r.rn = 1 THEN '00000000-0000-0000-0000-000000000026'::uuid
    WHEN r.rn = 2 THEN '00000000-0000-0000-0000-000000000028'::uuid
    WHEN r.rn = 3 THEN '00000000-0000-0000-0000-000000000030'::uuid
    WHEN r.rn = 4 THEN '00000000-0000-0000-0000-000000000032'::uuid
    WHEN r.rn = 5 THEN '00000000-0000-0000-0000-000000000002'::uuid
    WHEN r.rn = 6 THEN '00000000-0000-0000-0000-000000000004'::uuid
    WHEN r.rn = 7 THEN '00000000-0000-0000-0000-000000000006'::uuid
    WHEN r.rn = 8 THEN '00000000-0000-0000-0000-000000000008'::uuid
    WHEN r.rn = 9 THEN '00000000-0000-0000-0000-000000000010'::uuid
    WHEN r.rn = 10 THEN '00000000-0000-0000-0000-000000000012'::uuid
    WHEN r.rn = 11 THEN '00000000-0000-0000-0000-000000000014'::uuid
    WHEN r.rn = 12 THEN '00000000-0000-0000-0000-000000000016'::uuid
    WHEN r.rn = 13 THEN '00000000-0000-0000-0000-000000000018'::uuid
    WHEN r.rn = 14 THEN '00000000-0000-0000-0000-000000000020'::uuid
    WHEN r.rn = 15 THEN '00000000-0000-0000-0000-000000000022'::uuid
    WHEN r.rn = 16 THEN '00000000-0000-0000-0000-000000000024'::uuid
  END
FROM r32_matches r
WHERE m.id = r.id;

-- Round of 16
WITH r16_matches AS (
  SELECT id, ROW_NUMBER() OVER (ORDER BY match_date) as rn
  FROM matches WHERE stage = 'Round of 16'
)
UPDATE matches m SET
  home_team_id = CASE
    WHEN r.rn = 1 THEN '00000000-0000-0000-0000-000000000033'::uuid
    WHEN r.rn = 2 THEN '00000000-0000-0000-0000-000000000035'::uuid
    WHEN r.rn = 3 THEN '00000000-0000-0000-0000-000000000037'::uuid
    WHEN r.rn = 4 THEN '00000000-0000-0000-0000-000000000039'::uuid
    WHEN r.rn = 5 THEN '00000000-0000-0000-0000-00000000003b'::uuid
    WHEN r.rn = 6 THEN '00000000-0000-0000-0000-00000000003d'::uuid
    WHEN r.rn = 7 THEN '00000000-0000-0000-0000-00000000003f'::uuid
    WHEN r.rn = 8 THEN '00000000-0000-0000-0000-000000000071'::uuid
  END,
  away_team_id = CASE
    WHEN r.rn = 1 THEN '00000000-0000-0000-0000-000000000034'::uuid
    WHEN r.rn = 2 THEN '00000000-0000-0000-0000-000000000036'::uuid
    WHEN r.rn = 3 THEN '00000000-0000-0000-0000-000000000038'::uuid
    WHEN r.rn = 4 THEN '00000000-0000-0000-0000-00000000003a'::uuid
    WHEN r.rn = 5 THEN '00000000-0000-0000-0000-00000000003c'::uuid
    WHEN r.rn = 6 THEN '00000000-0000-0000-0000-00000000003e'::uuid
    WHEN r.rn = 7 THEN '00000000-0000-0000-0000-000000000040'::uuid
    WHEN r.rn = 8 THEN '00000000-0000-0000-0000-000000000072'::uuid
  END
FROM r16_matches r
WHERE m.id = r.id;

-- Quarter-finals
WITH qf_matches AS (
  SELECT id, ROW_NUMBER() OVER (ORDER BY match_date) as rn
  FROM matches WHERE stage = 'Quarter-finals'
)
UPDATE matches m SET
  home_team_id = CASE
    WHEN r.rn = 1 THEN '00000000-0000-0000-0000-000000000041'::uuid
    WHEN r.rn = 2 THEN '00000000-0000-0000-0000-000000000043'::uuid
    WHEN r.rn = 3 THEN '00000000-0000-0000-0000-000000000045'::uuid
    WHEN r.rn = 4 THEN '00000000-0000-0000-0000-000000000047'::uuid
  END,
  away_team_id = CASE
    WHEN r.rn = 1 THEN '00000000-0000-0000-0000-000000000042'::uuid
    WHEN r.rn = 2 THEN '00000000-0000-0000-0000-000000000044'::uuid
    WHEN r.rn = 3 THEN '00000000-0000-0000-0000-000000000046'::uuid
    WHEN r.rn = 4 THEN '00000000-0000-0000-0000-000000000048'::uuid
  END
FROM qf_matches r
WHERE m.id = r.id;

-- Semi-finals
WITH sf_matches AS (
  SELECT id, ROW_NUMBER() OVER (ORDER BY match_date) as rn
  FROM matches WHERE stage = 'Semi-finals'
)
UPDATE matches m SET
  home_team_id = CASE
    WHEN r.rn = 1 THEN '00000000-0000-0000-0000-000000000051'::uuid
    WHEN r.rn = 2 THEN '00000000-0000-0000-0000-000000000053'::uuid
  END,
  away_team_id = CASE
    WHEN r.rn = 1 THEN '00000000-0000-0000-0000-000000000052'::uuid
    WHEN r.rn = 2 THEN '00000000-0000-0000-0000-000000000054'::uuid
  END
FROM sf_matches r
WHERE m.id = r.id;

-- Third Place
UPDATE matches SET
  home_team_id = '00000000-0000-0000-0000-000000000063'::uuid,
  away_team_id = '00000000-0000-0000-0000-000000000064'::uuid
WHERE stage = 'Third Place';

-- Final
UPDATE matches SET
  home_team_id = '00000000-0000-0000-0000-000000000061'::uuid,
  away_team_id = '00000000-0000-0000-0000-000000000062'::uuid
WHERE stage = 'Final';
